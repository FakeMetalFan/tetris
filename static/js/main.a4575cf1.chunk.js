(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{136:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(49),c=(n(58),function(e){var t=e.state,n=e.width;return a.a.createElement("div",{className:"display",style:{gridTemplateColumns:"repeat(".concat(n,", 1fr)")}},t.map((function(e){return e.map((function(e,t){return a.a.createElement(re,{key:t,state:e})}))})))}),s=n(19),i=(n(64),function(){return a.a.createElement("footer",null,a.a.createElement("span",null,"Powered by",a.a.createElement("a",{href:"https://github.com/FakeMetalFan",target:"_blank",rel:"noopener noreferrer"},a.a.createElement(s.a,{icon:["fab","github"]})),"\xa9",a.a.createElement("span",null,(new Date).getFullYear())))}),u=(n(65),function(){return a.a.createElement("header",null,a.a.createElement("span",{className:"title"},"Tetris"),a.a.createElement("a",{href:"https://github.com/FakeMetalFan/tetris",target:"_blank",rel:"noopener noreferrer"},a.a.createElement(s.a,{icon:["fab","github"]})))}),f=n(5),l=n(2),d=function(e){var t=Object(r.useRef)(),n=Object(r.useRef)(!1);Object(r.useEffect)((function(){t.current=e}),[e]);for(var a=arguments.length,o=new Array(a>1?a-1:0),c=1;c<a;c++)o[c-1]=arguments[c];Object(r.useEffect)((function(){n.current?t.current():n.current=!0}),o)},p=n(50),m=n.n(p),b=37,w=38,h=39,v=40,y=0,j=1,O=2,A=3,E=4,g=5,k=6,R=7,x=[[[y,j,y,y],[y,j,y,y],[y,j,y,y],[y,j,y,y]],[[y,O,y],[y,O,y],[O,O,y]],[[y,A,y],[y,A,y],[y,A,A]],[[E,E],[E,E]],[[y,g,g],[g,g,y],[y,y,y]],[[y,k,y],[k,k,k],[y,y,y]],[[R,R,y],[y,R,R],[y,y,y]]],C=function(e){return Object(l.a)(e,(function(t){t.forEach((function(n,r){t[r]=e.map((function(e){return e[r]}))})),t.map((function(e){return e.reverse()}))}))},D="draw-tetromino",M="sweep-filled-rows",F="merge-state",N="reset",I=function(e,t){var n=t.type,r=t.payload;return n===N?m()(r):Object(l.a)(e,(function(e){switch(n){case D:e.current=Object(l.a)(e.merged,(function(e){var t=r.matrix,n=r.position;t.forEach((function(t,r){t.forEach((function(t,a){t!==y&&(e[r+n.rowAddress][a+n.colAddress]=t)}))}))}));break;case M:var t=r.filledRowsAddresses,a=r.emptyRow;e.sweptRowsCount+=t.length,e.merged=Object(l.a)(e.current,(function(e){t.forEach((function(t){e.splice(t,1),e.unshift(a)}))}));break;case F:e.merged=e.current}}))},_="random",z="rotation",S="move",J=function(e,t){var n=t.type,r=t.payload;return Object(l.a)(e,(function(e){switch(n){case _:e.matrix=x[Math.random()*x.length|0],e.position={rowAddress:0,colAddress:(r.width-e.matrix.length)/2|0};break;case S:var t=r.offset,a=t.rowAddress,o=void 0===a?0:a,c=t.colAddress,s=void 0===c?0:c;e.position=Object(l.a)(e.position,(function(e){e.rowAddress+=o,e.colAddress+=s}));break;case z:e.matrix=C(e.matrix)}}))},K=function(e){var t=e.width,n=Object(r.useReducer)(J,{matrix:[],position:{rowAddress:0,colAddress:0}}),a=Object(f.a)(n,2),o=a[0],c=o.matrix,s=o.position,i=a[1];return{matrix:c,position:s,randomize:function(){i({type:_,payload:{width:t}})},makeMove:function(e){var t=e.isRotation,n=e.offset;i(t?{type:z}:{type:S,payload:{offset:n}})}}},T=n(11),U=n(10),B=n(6),P=n(51),Y=function(){function e(){Object(B.a)(this,e)}return Object(P.a)(e,[{key:"isRotation",get:function(){return this instanceof G}},{key:"isDown",get:function(){return this instanceof L}}]),e}(),q=function(e){Object(T.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(B.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).offset={rowAddress:0,colAddress:-1},e}return n}(Y),G=function(e){Object(T.a)(n,e);var t=Object(U.a)(n);function n(){return Object(B.a)(this,n),t.apply(this,arguments)}return n}(Y),H=function(e){Object(T.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(B.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).offset={rowAddress:0,colAddress:1},e}return n}(Y),L=function(e){Object(T.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(B.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).offset={rowAddress:1,colAddress:0},e}return n}(Y),Q=(n(136),"left-move"),V="rotation",W="right-move",X="down-move",Z="enable-auto-drop",$="update-score",ee="auto-drop",te=function(e,t){var n=t.type,r=t.payload;return Object(l.a)(e,(function(e){switch(n){case Q:e.move=new q;break;case V:e.move=new G;break;case W:e.move=new H;break;case X:e.isAutoDrop=!1,e.move=new L;break;case Z:e.isAutoDrop=!0;break;case $:var t=r.sweptRowsCount;e.score=t?e.score+10*t:0;break;case ee:e.move=new L}}))},ne=function(e){var t=e.width,n=e.height,o=Object(r.useReducer)(te,{score:0,move:null,isAutoDrop:!0}),s=Object(f.a)(o,2),i=s[0],u=i.score,l=i.move,p=i.isAutoDrop,m=s[1],j=function(e){var t=e.width,n=e.height,a=e.move,o=Object(r.useMemo)((function(){return Array(t).fill(y)}),[t]),c=Object(r.useMemo)((function(){return Array(n).fill(o)}),[o,n]),s={current:c,merged:c,sweptRowsCount:0},i=Object(r.useReducer)(I,s),u=Object(f.a)(i,2),l=u[0],p=l.current,m=l.merged,b=l.sweptRowsCount,w=u[1],h=K({width:t}),v=h.matrix,j=h.position,O=h.randomize,A=h.makeMove,E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.tetrominoState,a=void 0===r?v:r,o=e.offset,c=void 0===o?{rowAddress:0,colAddress:0}:o;return a.some((function(e,r){return e.some((function(e,a){var o,s=r+j.rowAddress+c.rowAddress,i=a+j.colAddress+c.colAddress;return e!==y&&((null===(o=m[s])||void 0===o?void 0:o[i])!==y||s>=n||i>=t||i<0)}))}))};return Object(r.useEffect)((function(){O()}),[m]),Object(r.useEffect)((function(){w(E()?{type:N,payload:s}:{type:D,payload:{matrix:v,position:j}})}),[v,j]),d((function(){if(E(a.isRotation?{tetrominoState:C(v)}:a)){if(a.isDown){var e=p.reduce((function(e,t,n){return!t.some((function(e){return e===y}))&&e.push(n),e}),[]);w(e.length?{type:M,payload:{filledRowsAddresses:e,emptyRow:o}}:{type:F})}}else A(a)}),a),{sweptRowsCount:b,display:p}}({width:t,height:n,move:l}),O=j.display,A=j.sweptRowsCount,E=Object(r.useRef)();return Object(r.useEffect)((function(){E.current.focus()}),[]),d((function(){m({type:$,payload:{sweptRowsCount:A}})}),A),function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(t){var e=setInterval((function(){n.current()}),t);return function(){clearInterval(e)}}}),[t])}((function(){m({type:ee})}),p?800:null),a.a.createElement("div",{className:"tetris",tabIndex:"0",onKeyDown:function(e){var t=e.keyCode;t===b&&m({type:Q}),t===w&&m({type:V}),t===h&&m({type:W}),t===v&&m({type:X})},onKeyUp:function(e){e.keyCode===v&&m({type:Z})},ref:E},a.a.createElement("div",{className:"score"},u),a.a.createElement(c,{state:O,width:t}))},re=(n(137),Object(r.memo)((function(e){var t=e.state,n="tile tile__";switch(t){case y:n+="none";break;case j:n+="i";break;case O:n+="j";break;case A:n+="l";break;case E:n+="o";break;case g:n+="s";break;case k:n+="t";break;case R:n+="z";break;default:throw new Error('Unexpected tile of "'.concat(t,'"!'))}return a.a.createElement("div",{className:n})}))),ae=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(u,null),a.a.createElement(ne,{width:10,height:20}),a.a.createElement(i,null))},oe=n(9),ce=n(52);n(138);oe.b.add(ce.a),Object(o.render)(a.a.createElement(r.StrictMode,null,a.a.createElement(ae,null)),document.getElementById("root"))},53:function(e,t,n){e.exports=n(139)},58:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){}},[[53,1,2]]]);
//# sourceMappingURL=main.a4575cf1.chunk.js.map