(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{133:function(e,t,r){},134:function(e,t,r){},135:function(e,t,r){},136:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),a=r(47),c=(r(55),function(e){var t=e.state,r=e.width;return o.a.createElement("div",{className:"display",style:{gridTemplateColumns:"repeat(".concat(r,", 1fr)")}},t.map((function(e){return e.map((function(e,t){return o.a.createElement(X,{key:t,state:e})}))})))}),s=r(16),i=(r(61),function(){return o.a.createElement("footer",null,o.a.createElement("span",null,"Powered by",o.a.createElement("a",{href:"https://github.com/FakeMetalFan",target:"_blank",rel:"noopener noreferrer"},o.a.createElement(s.a,{icon:["fab","github"]})),"\xa9",o.a.createElement("span",null,(new Date).getFullYear())))}),u=(r(62),function(){return o.a.createElement("header",null,o.a.createElement("span",{className:"title"},"Tetris"),o.a.createElement("a",{href:"https://github.com/FakeMetalFan/tetris",target:"_blank",rel:"noopener noreferrer"},o.a.createElement(s.a,{icon:["fab","github"]})))}),l=r(5),f=r(29),d=r(2),m=function(e){var t=Object(n.useRef)(),r=Object(n.useRef)(!1);Object(n.useEffect)((function(){t.current=e}),[e]);for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];Object(n.useEffect)((function(){r.current?t.current():r.current=!0}),a)},p=r(48),b=r.n(p),w=37,v=38,h=39,y=40,E=0,j=1,A=2,g=3,O=4,k=5,R=6,x=7,C=[[[E,j,E,E],[E,j,E,E],[E,j,E,E],[E,j,E,E]],[[E,A,E],[E,A,E],[A,A,E]],[[E,g,E],[E,g,E],[E,g,g]],[[O,O],[O,O]],[[E,k,k],[k,k,E],[E,E,E]],[[E,R,E],[R,R,R],[E,E,E]],[[x,x,E],[E,x,x],[E,E,E]]],D=function(e){return e===E},M=function(e){return Object(d.a)(e,(function(t){t.forEach((function(r,n){t[n]=e.map((function(e){return e[n]}))})),t.map((function(e){return e.reverse()}))}))},F="tetromino-drawing",N="filled-rows-sweep",z="state-merging",I="reset",_=function(e,t){var r=t.type,n=t.payload;return r===I?b()(n):Object(d.a)(e,(function(e){switch(r){case F:e.current=Object(d.a)(e.merged,(function(e){var t=n.matrix,r=n.position;t.forEach((function(t,n){t.forEach((function(t,o){!D(t)&&(e[n+r.rowAddress][o+r.colAddress]=t)}))}))}));break;case N:var t=n.filledRowsAddresses,o=n.emptyRow;e.sweptRowsCount+=t.length,e.merged=Object(d.a)(e.current,(function(e){t.forEach((function(t){e.splice(t,1),e.unshift(o)}))}));break;case z:e.merged=e.current}}))},S="randomization",J="rotation",K="move",T=function(e,t){var r=t.type,n=t.payload;return Object(d.a)(e,(function(e){switch(r){case S:e.matrix=C[Math.random()*C.length|0],e.position={rowAddress:0,colAddress:(n-e.matrix.length)/2|0};break;case K:var t=n.rowAddress,o=n.colAddress;e.position=Object(d.a)(e.position,(function(e){e.rowAddress+=t,e.colAddress+=o}));break;case J:e.matrix=M(e.matrix)}}))},U=function(e){var t=e.width,r=Object(n.useReducer)(T,{matrix:[],position:{rowAddress:0,colAddress:0}}),o=Object(l.a)(r,2),a=o[0],c=a.matrix,s=a.position,i=o[1];return{matrix:c,position:s,randomize:function(){i({type:S,payload:t})},makeMove:function(e){var t=e.isRotation,r=e.offset;i(t?{type:J}:{type:K,payload:r})}}},B=(r(133),"left-move"),P="rotation",Y="right-move",q="down-move",G="auto-drop-enabling",H="score-update",L="auto-drop",Q={isDown:!0,offset:{rowAddress:1,colAddress:0}},V=function(e,t){var r=t.type,n=t.payload;return Object(d.a)(e,(function(e){switch(r){case B:e.move={offset:{rowAddress:0,colAddress:-1}};break;case P:e.move={isRotation:!0};break;case Y:e.move={offset:{rowAddress:0,colAddress:1}};break;case q:e.isAutoDrop=!1,e.move=Object(f.a)({},Q);break;case G:e.isAutoDrop=!0;break;case H:e.score=n?e.score+10*n:0;break;case L:e.move=Object(f.a)({},Q)}}))},W=function(e){var t=e.width,r=e.height,a=Object(n.useReducer)(V,{score:0,move:null,isAutoDrop:!0}),s=Object(l.a)(a,2),i=s[0],u=i.score,f=i.move,d=i.isAutoDrop,p=s[1],b=function(e){var t=e.width,r=e.height,o=e.move,a=Object(n.useMemo)((function(){return Array(t).fill(E)}),[t]),c=Object(n.useMemo)((function(){return Array(r).fill(a)}),[a,r]),s={current:c,merged:c,sweptRowsCount:0},i=Object(n.useReducer)(_,s),u=Object(l.a)(i,2),f=u[0],d=f.current,p=f.merged,b=f.sweptRowsCount,w=u[1],v=U({width:t}),h=v.matrix,y=v.position,j=v.randomize,A=v.makeMove,g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.tetrominoState,o=void 0===n?h:n,a=e.offset,c=void 0===a?{rowAddress:0,colAddress:0}:a;return o.some((function(e,n){return e.some((function(e,o){var a,s=n+y.rowAddress+c.rowAddress,i=o+y.colAddress+c.colAddress;return!D(e)&&(!D(null===(a=p[s])||void 0===a?void 0:a[i])||s>=r||i>=t||i<0)}))}))};return Object(n.useEffect)((function(){j()}),[p]),Object(n.useEffect)((function(){w(g()?{type:I,payload:s}:{type:F,payload:{matrix:h,position:y}})}),[h,y]),m((function(){var e=g(o.isRotation?{tetrominoState:M(h)}:o);if(e&&o.isDown){var t=d.reduce((function(e,t,r){return!t.some(D)&&e.push(r),e}),[]);w(t.length?{type:N,payload:{filledRowsAddresses:t,emptyRow:a}}:{type:z})}else e||A(o)}),o),{sweptRowsCount:b,display:d}}({width:t,height:r,move:f}),j=b.display,A=b.sweptRowsCount,g=Object(n.useRef)();return Object(n.useEffect)((function(){g.current.focus()}),[]),m((function(){p({type:H,payload:A})}),A),function(e,t){var r=Object(n.useRef)();Object(n.useEffect)((function(){r.current=e}),[e]),Object(n.useEffect)((function(){if(t){var e=setInterval((function(){r.current()}),t);return function(){clearInterval(e)}}}),[t])}((function(){p({type:L})}),d?800:null),o.a.createElement("div",{className:"tetris",tabIndex:"0",onKeyDown:function(e){var t=e.keyCode;t===w&&p({type:B}),t===v&&p({type:P}),t===h&&p({type:Y}),t===y&&p({type:q})},onKeyUp:function(e){e.keyCode===y&&p({type:G})},ref:g},o.a.createElement("div",{className:"score"},u),o.a.createElement(c,{state:j,width:t}))},X=(r(134),Object(n.memo)((function(e){var t=e.state,r="tile tile__";switch(t){case E:r="tile";break;case j:r+="i";break;case A:r+="j";break;case g:r+="l";break;case O:r+="o";break;case k:r+="s";break;case R:r+="t";break;case x:r+="z";break;default:throw new Error('Unexpected tile of "'.concat(t,'"!'))}return o.a.createElement("div",{className:r})}))),Z=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(u,null),o.a.createElement(W,{width:10,height:20}),o.a.createElement(i,null))},$=r(8),ee=r(49);r(135);$.b.add(ee.a),Object(a.render)(o.a.createElement(n.StrictMode,null,o.a.createElement(Z,null)),document.getElementById("root"))},50:function(e,t,r){e.exports=r(136)},55:function(e,t,r){},61:function(e,t,r){},62:function(e,t,r){}},[[50,1,2]]]);
//# sourceMappingURL=main.8ce1bbc7.chunk.js.map