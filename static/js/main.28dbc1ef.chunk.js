(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{187:function(e,t,n){},188:function(e,t,n){},189:function(e,t,n){},190:function(e,t,n){"use strict";n.r(t);var r,c=n(0),o=n.n(c),i=n(70),a=(n(81),function(e){var t=e.state,n=e.columnsCount;return o.a.createElement("div",{className:"display",style:{gridTemplateColumns:"repeat(".concat(n,", 1fr)")}},t.map((function(e,t){return e.map((function(e,r){return o.a.createElement(ce,{key:r*n+t,state:e})}))})))}),u=n(28),s=(n(87),function(){return o.a.createElement("footer",null,o.a.createElement("span",null,"Powered by",o.a.createElement("a",{className:"icon",href:"https://github.com/FakeMetalFan",target:"_blank",rel:"noopener noreferrer"},o.a.createElement(u.a,{icon:["fab","github"]})),"\xa9",o.a.createElement("span",null,(new Date).getFullYear())))}),l=(n(88),function(){return o.a.createElement("header",null,o.a.createElement("span",{className:"title"},"Tetris"),o.a.createElement("a",{className:"icon",href:"https://github.com/FakeMetalFan/tetris",target:"_blank",rel:"noopener noreferrer"},o.a.createElement(u.a,{icon:["fab","github"]})))}),f=n(5),w=function(e){for(var t=Object(c.useRef)(!1),n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];Object(c.useEffect)((function(){t.current?e():t.current=!0}),r)},d=n(7),b=n(71),h=n.n(b),p=n(17),O=n(16),m=n(4),j=n(6),v=n(191),g=37,y=38,E=39,k=40,A=1,C=2,M=3,R=4,x=-1,S=1,_=2,D=3,N=4,F=5,I=6,P=7,z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x;Object(m.a)(this,e),this[d.b]=!0,this.fill=t}return Object(j.a)(e,[{key:"isEmpty",get:function(){return this.fill===x}}]),e}(),J=n(30),T=n(72),K=n.n(T),U=function(e,t,n){var r=n.value;return n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return K()(r.apply(this,t))},n},B=(r=function(){function e(t){Object(m.a)(this,e),this.id=Object(v.a)(),this.position={rowAddress:0,colAddress:0},this.matrix=t}return Object(j.a)(e,[{key:"getCloned",value:function(e){return this.id=Object(v.a)(),this.position.colAddress=e,this}},{key:"getMoved",value:function(e){var t=e.rowAddress,n=void 0===t?0:t,r=e.colAddress,c=void 0===r?0:r;return this.position=Object(d.a)(this.position,(function(e){e.rowAddress+=n,e.colAddress+=c})),this}},{key:"getRotated",value:function(e){var t=this;return this.matrix=Object(d.a)(this.matrix,(function(n){n.forEach((function(e,r){n[r]=t.matrix.map((function(e){return e[r]}))})),e===Y.Clockwise?n.map((function(e){return e.reverse()})):n.reverse()})),this}},{key:"width",get:function(){return this.matrix.length}},{key:"rowAddress",get:function(){return this.position.rowAddress}},{key:"colAddress",get:function(){return this.position.colAddress}}]),e}(),Object(J.a)(r.prototype,"getCloned",[U],Object.getOwnPropertyDescriptor(r.prototype,"getCloned"),r.prototype),Object(J.a)(r.prototype,"getMoved",[U],Object.getOwnPropertyDescriptor(r.prototype,"getMoved"),r.prototype),Object(J.a)(r.prototype,"getRotated",[U],Object.getOwnPropertyDescriptor(r.prototype,"getRotated"),r.prototype),r),L=(new Map).set("I",new B([[new z,new z(S),new z,new z],[new z,new z(S),new z,new z],[new z,new z(S),new z,new z],[new z,new z(S),new z,new z]])).set("J",new B([[new z,new z(_),new z],[new z,new z(_),new z],[new z(_),new z(_),new z]])).set("L",new B([[new z,new z(D),new z],[new z,new z(D),new z],[new z,new z(D),new z(D)]])).set("O",new B([[new z(N),new z(N)],[new z(N),new z(N)]])).set("S",new B([[new z,new z(F),new z(F)],[new z(F),new z(F),new z],[new z,new z,new z]])).set("T",new B([[new z,new z(I),new z],[new z(I),new z(I),new z(I)],[new z,new z,new z]])).set("Z",new B([[new z(P),new z(P),new z],[new z,new z(P),new z(P)],[new z,new z,new z]])),Y={Clockwise:1,Counterclockwise:-1},Z={colAddress:-1},q={colAddress:1},G={rowAddress:1},H=function(){function e(t){Object(m.a)(this,e),this._id=Object(v.a)(),this._code=t}return Object(j.a)(e,[{key:"isRotation",get:function(){return this._code===C}},{key:"isDown",get:function(){return this._code===R}}]),e}(),Q=function(e){Object(p.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(m.a)(this,n),(e=t.call(this,A)).offset=Z,e}return Object(j.a)(n,[{key:"getOppositeMove",value:function(){return new W}}]),n}(H),V=function(e){Object(p.a)(n,e);var t=Object(O.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.Clockwise;return Object(m.a)(this,n),(e=t.call(this,C)).direction=r,e}return Object(j.a)(n,[{key:"getOppositeMove",value:function(){return new n(Y[this.direction===Y.Clockwise?"Counterclockwise":"Clockwise"])}}]),n}(H),W=function(e){Object(p.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(m.a)(this,n),(e=t.call(this,M)).offset=q,e}return Object(j.a)(n,[{key:"getOppositeMove",value:function(){return new Q}}]),n}(H),X=function(e){Object(p.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(m.a)(this,n),(e=t.call(this,R)).offset=G,e}return n}(H),$=function(e){var t=Object(c.useRef)(e),n=Object(c.useCallback)((function(e){t.current=e}),[]);return[t.current,n]},ee=n(74),te=function(e){var t=e.width,n=function(){var e=Object(ee.a)(L.keys()),n=L.get(e[Math.random()*e.length|0]);return n.getCloned((t-n.width)/2|0)},r=Object(c.useState)((function(){return n()})),o=Object(f.a)(r,2),i=o[0],a=o[1];return{tetromino:i,randomize:function(){a(n())},makeMove:function(e){a(e.isRotation?i.getRotated(e.direction):i.getMoved(e.offset))}}},ne=(n(187),function(){var e=Object(c.useState)(800),t=Object(f.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)(0),u=Object(f.a)(i,2),s=u[0],l=u[1],b=Object(c.useState)(null),p=Object(f.a)(b,2),O=p[0],m=p[1],j=function(e){var t=e.width,n=e.height,r=e.move,o=Object(c.useMemo)((function(){return Array(t).fill(new z)}),[t]),i=Object(c.useMemo)((function(){return Array(n).fill(o)}),[o,n]),a=Object(c.useState)(i),u=Object(f.a)(a,2),s=u[0],l=u[1],b=Object(c.useState)(0),p=Object(f.a)(b,2),O=p[0],m=p[1],j=te({width:t}),v=j.tetromino,g=j.randomize,y=j.makeMove,E=$(s),k=Object(f.a)(E,2),A=k[0],C=k[1],M=function(){return v.matrix.some((function(e,r){return e.some((function(e,c){var o,i,a=e.isEmpty,u=r+v.rowAddress,s=c+v.colAddress;return!a&&(!(null===(o=A[u])||void 0===o||null===(i=o[s])||void 0===i?void 0:i.isEmpty)||u>=n||s>=t||s<0)}))}))};return Object(c.useEffect)((function(){M()?r.isDown?(C(s),g()):y(r.getOppositeMove()):l(Object(d.a)(A,(function(e){v.matrix.forEach((function(t,n){t.forEach((function(t,r){!t.isEmpty&&(e[n+v.rowAddress][r+v.colAddress]=t)}))}))})))}),[v.matrix,v.position]),w((function(){y(r)}),r),w((function(){var e=A.reduce((function(e,t,n){return!h()(t,"isEmpty")&&e.push(n),e}),[]);e.length&&(C(Object(d.a)(A,(function(t){e.forEach((function(e){t.splice(e,1),t.unshift(o)}))}))),m((function(t){return t+e.length})))}),A),w((function(){M()&&(l(i),C(i),m(0))}),v.id),{display:s,sweptRowsCount:O}}({width:10,move:O,height:20}),v=j.display,A=j.sweptRowsCount,C=Object(c.useRef)(),M=function(){m(new X)};return Object(c.useEffect)((function(){C.current.focus()}),[]),w((function(){l((function(e){return A?e+10*A:0}))}),A),function(e,t){var n=Object(c.useRef)();Object(c.useEffect)((function(){n.current=e}),[e]),Object(c.useEffect)((function(){if(t){var e=setInterval((function(){n.current()}),t);return function(){clearInterval(e)}}}),[t])}((function(){M()}),n),o.a.createElement("div",{className:"tetris",tabIndex:"0",onKeyDown:function(e){var t=e.keyCode;t===g&&m(new Q),t===y&&m(new V),t===E&&m(new W),t===k&&(r(null),M())},onKeyUp:function(e){e.keyCode===k&&r(800)},ref:C},o.a.createElement("div",{className:"score"},s),o.a.createElement(a,{state:v,columnsCount:10}))}),re=function(e){var t="tile tile__";switch(e){case x:return"".concat(t,"none");case S:return"".concat(t,"i");case _:return"".concat(t,"j");case D:return"".concat(t,"l");case N:return"".concat(t,"o");case F:return"".concat(t,"s");case I:return"".concat(t,"t");case P:return"".concat(t,"z");default:throw new Error('Unexpected tile fill of "'.concat(e,'"!'))}},ce=(n(188),Object(c.memo)((function(e){var t=e.state;return o.a.createElement("div",{className:re(t.fill)})}))),oe=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(l,null),o.a.createElement(ne,null),o.a.createElement(s,null))},ie=n(14),ae=n(73);n(189);ie.b.add(ae.a),Object(i.render)(o.a.createElement(c.StrictMode,null,o.a.createElement(oe,null)),document.getElementById("root"))},76:function(e,t,n){e.exports=n(190)},81:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){}},[[76,1,2]]]);
//# sourceMappingURL=main.28dbc1ef.chunk.js.map