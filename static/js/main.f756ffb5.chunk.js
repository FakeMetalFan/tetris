(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{12:function(t,e,n){t.exports={footer:"footer_footer__2RxHW",link:"footer_link__2KGou"}},13:function(t,e,n){t.exports={header:"header_header__2l8_Z",link:"header_link__3G0Uu"}},21:function(t,e,n){},32:function(t,e,n){"use strict";n.r(e);n(21);var r,o=n(0),i=n(1),c=function(t){var e=t.count;return Object(i.jsx)("div",{children:e})},a=Object(o.memo)(c),u=n(9),s=n(12),f=n.n(s),l=function(){return Object(i.jsx)("footer",{className:f.a.footer,children:Object(i.jsxs)("span",{children:["Powered by",Object(i.jsx)("a",{className:f.a.link,href:"https://github.com/FakeMetalFan",target:"_blank",rel:"noopener noreferrer",children:Object(i.jsx)(u.a,{icon:["fab","github"]})}),"\xa9",Object(i.jsx)("span",{children:(new Date).getFullYear()})]})})},m=Object(o.memo)(l),j=n(13),b=n.n(j),d=function(){return Object(i.jsxs)("header",{className:b.a.header,children:["Tetris",Object(i.jsx)("a",{className:b.a.link,href:"https://github.com/FakeMetalFan/tetris",target:"_blank",rel:"noopener noreferrer",children:Object(i.jsx)(u.a,{icon:["fab","github"]})})]})},p=Object(o.memo)(d),O=n(3),h=n(15),y=n.n(h),E=n(16),x=n(17);!function(t){t[t.Empty=0]="Empty",t[t.I=1]="I",t[t.J=2]="J",t[t.L=3]="L",t[t.O=4]="O",t[t.S=5]="S",t[t.T=6]="T",t[t.Z=7]="Z"}(r||(r={}));var w,_=r,v=function(){function t(e){Object(E.a)(this,t),this.fill=e}return Object(x.a)(t,[{key:"isEmpty",get:function(){return this.fill===_.Empty}},{key:"isI",get:function(){return this.fill===_.I}},{key:"isJ",get:function(){return this.fill===_.J}},{key:"isL",get:function(){return this.fill===_.L}},{key:"isO",get:function(){return this.fill===_.O}},{key:"isS",get:function(){return this.fill===_.S}},{key:"isT",get:function(){return this.fill===_.T}},{key:"isZ",get:function(){return this.fill===_.Z}}]),t}(),I=n(5),g=n.n(I),k=function(t){var e,n=t.fill,r=new v(n),o=r.isI,c=r.isJ,a=r.isL,u=r.isO,s=r.isS,f=r.isT,l=r.isZ;return Object(i.jsx)("button",{type:"button","aria-label":"tile",className:y()(g.a.tile,(e={},Object(O.a)(e,g.a.i,o),Object(O.a)(e,g.a.j,c),Object(O.a)(e,g.a.l,a),Object(O.a)(e,g.a.o,u),Object(O.a)(e,g.a.s,s),Object(O.a)(e,g.a.t,f),Object(O.a)(e,g.a.z,l),e))})},R=Object(o.memo)(k);!function(t){t[t.ArrowLeft=37]="ArrowLeft",t[t.ArrowUp=38]="ArrowUp",t[t.ArrowRight=39]="ArrowRight",t[t.ArrowDown=40]="ArrowDown"}(w||(w={}));var A,S=w;!function(t){t[t.Rotation=0]="Rotation",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Down=3]="Down"}(A||(A={}));var L=A,D=function(t){Object(o.useEffect)((function(){t()}),[])},J=n(4),M=n(6),T=n(14),Z=n(20),N=function(t){return Object(T.a)(Object(T.a)({},t),{},{id:Object(Z.a)()})},F=function(t){switch(t){case L.Rotation:return{isRotation:!0};case L.Left:return{offset:{rowIndex:0,columnIndex:-1}};case L.Right:return{offset:{rowIndex:0,columnIndex:1}};case L.Down:default:return{isDown:!0,offset:{rowIndex:1,columnIndex:0}}}},z=function(t){return Object(M.a)(t,(function(e){e.forEach((function(n,r){e[r]=t.map((function(t){return t[r]}))})),e.map((function(t){return t.reverse()}))}))},U=function(t){for(var e=Object(o.useRef)(!1),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Object(o.useEffect)((function(){e.current?t():e.current=!0}),r)},C=function(t,e){var n=Object(o.useRef)();Object(o.useEffect)((function(){n.current=t})),Object(o.useEffect)((function(){if(e){var t=setInterval((function(){var t;null===(t=n.current)||void 0===t||t.call(n)}),e);return function(){clearInterval(t)}}}),[e])},B=[[[_.Empty,_.I,_.Empty,_.Empty],[_.Empty,_.I,_.Empty,_.Empty],[_.Empty,_.I,_.Empty,_.Empty],[_.Empty,_.I,_.Empty,_.Empty]],[[_.Empty,_.J,_.Empty],[_.Empty,_.J,_.Empty],[_.J,_.J,_.Empty]],[[_.Empty,_.L,_.Empty],[_.Empty,_.L,_.Empty],[_.Empty,_.L,_.L]],[[_.O,_.O],[_.O,_.O]],[[_.Empty,_.S,_.S],[_.S,_.S,_.Empty],[_.Empty,_.Empty,_.Empty]],[[_.Empty,_.T,_.Empty],[_.T,_.T,_.T],[_.Empty,_.Empty,_.Empty]],[[_.Z,_.Z,_.Empty],[_.Empty,_.Z,_.Z],[_.Empty,_.Empty,_.Empty]]],G=function(t){var e=t.width,n=Object(o.useState)([]),r=Object(J.a)(n,2),i=r[0],c=r[1],a=Object(o.useState)({rowIndex:0,columnIndex:0}),u=Object(J.a)(a,2),s=u[0],f=u[1];return{tetromino:i,position:s,randomize:function(){var t=B[Math.floor(Math.random()*B.length)];c(t),f({rowIndex:0,columnIndex:Math.floor((e-t.length)/2)})},makeMove:function(t){var e=t.isRotation,n=t.offset,r=void 0===n?{rowIndex:0,columnIndex:0}:n;e?c(z(i)):f(Object(M.a)(s,(function(t){t.rowIndex+=r.rowIndex,t.columnIndex+=r.columnIndex})))}}},K=function(t){var e=t.width,n=t.height,r=Object(o.useMemo)((function(){return Array.from({length:n},(function(){return Array.from({length:e},(function(){return N({fill:_.Empty})}))}))}),[n,e]),i=Object(o.useState)(r),c=Object(J.a)(i,2),a=c[0],u=c[1],s=Object(o.useState)(r),f=Object(J.a)(s,2),l=f[0],m=f[1],j=Object(o.useState)(0),b=Object(J.a)(j,2),d=b[0],p=b[1],O=Object(o.useState)(0),h=Object(J.a)(O,2),y=h[0],E=h[1],x=Object(o.useState)({}),w=Object(J.a)(x,2),I=w[0],g=w[1],k=Object(o.useState)(!0),R=Object(J.a)(k,2),A=R[0],S=R[1],L=G(t),D=L.tetromino,T=L.position,Z=L.randomize,B=L.makeMove,K=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.matrix,o=void 0===r?D:r,i=t.offset,c=void 0===i?{rowIndex:0,columnIndex:0}:i;return o.some((function(t,r){return t.some((function(t,o){var i,a,u=r+T.rowIndex+c.rowIndex,s=o+T.columnIndex+c.columnIndex;return!new v(t).isEmpty&&(!new v(null===(i=l[u])||void 0===i||null===(a=i[s])||void 0===a?void 0:a.fill).isEmpty||u>=n||s>=e||s<0)}))}))};return Object(o.useEffect)((function(){Z()}),[l]),U((function(){K()?(u(r),m(r),p(0)):u(Object(M.a)(l,(function(t){D.forEach((function(e,n){e.forEach((function(e,r){new v(e).isEmpty||(t[n+T.rowIndex][r+T.columnIndex].fill=e)}))}))})))}),D,T),U((function(){var t=K(I.isRotation?{matrix:z(D)}:I);if(t&&I.isDown){var e=a.reduce((function(t,e,n){return e.some((function(t){return new v(t.fill).isEmpty}))||t.push(n),t}),[]),n=e.length;n?(p(d+n),m(Object(M.a)(a,(function(t){e.forEach((function(e){for(var n=function(e){t[e].forEach((function(n,r){n.fill=t[e-1][r].fill}))},r=e;r;r-=1)n(r)}))})))):m(a)}else t||B(I)}),I),U((function(){E(d?y+10*d:0)}),d),C((function(){g(F())}),A?1e3:null),{tiles:a,score:y,setMove:g,setIsAutoDrop:S}},W=n(8),q=n.n(W),H=function(t){var e=t.width,n=Object(o.useRef)(null),r=K(t),c=r.tiles,u=r.score,s=r.setMove,f=r.setIsAutoDrop;return D((function(){var t;null===(t=n.current)||void 0===t||t.focus()})),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(p,{}),Object(i.jsx)("main",{children:Object(i.jsxs)("a",{href:"/","data-testid":q.a.tetris,className:q.a.tetris,ref:n,onClick:function(t){t.preventDefault()},onKeyDown:function(t){switch(t.keyCode){case S.ArrowUp:s(F(L.Rotation));break;case S.ArrowLeft:s(F(L.Left));break;case S.ArrowRight:s(F(L.Right));break;case S.ArrowDown:default:f(!1),s(F())}},onKeyUp:function(t){t.keyCode===S.ArrowDown&&f(!0)},children:[Object(i.jsx)("div",{className:q.a.score,children:Object(i.jsx)(a,{count:u})}),Object(i.jsx)("div",{"data-testid":q.a.tiles,className:q.a.tiles,style:{gridTemplateColumns:"repeat(".concat(e,", 1fr)")},children:c.map((function(t){return t.map((function(t){var e=t.fill,n=t.id;return Object(i.jsx)(R,{fill:e},n)}))}))})]})}),Object(i.jsx)(m,{})]})},P=function(){return Object(i.jsx)(H,{width:10,height:20})},Q=n(18),X=n(7),Y=n(19);(function(){X.b.add(Y.a)})(),Object(Q.render)(Object(i.jsx)(o.StrictMode,{children:Object(i.jsx)(P,{})}),document.getElementById("root"))},5:function(t,e,n){t.exports={tile:"tile_tile__3mwM6",i:"tile_i__25_aJ",j:"tile_j__TNRBZ",l:"tile_l__Zpgje",o:"tile_o__2wu3P",s:"tile_s__12WnI",t:"tile_t__2_6li",z:"tile_z__2vgfH"}},8:function(t,e,n){t.exports={tetris:"tetris_tetris__1xn-2",tiles:"tetris_tiles__QqxGq",score:"tetris_score__XB5WE"}}},[[32,1,2]]]);
//# sourceMappingURL=main.f756ffb5.chunk.js.map