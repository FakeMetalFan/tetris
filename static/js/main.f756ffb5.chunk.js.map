{"version":3,"sources":["components/Footer/footer.module.scss","components/Header/header.module.scss","constants/tileFill.ts","components/Counter/index.tsx","components/Footer/index.tsx","components/Header/index.tsx","constants/keyCode.ts","utils/fillChecker.ts","components/Tile/index.tsx","constants/moveCode.ts","hooks/useDidMount.ts","utils/addId.ts","utils/createMove.ts","utils/rotateMatrix.ts","hooks/useDidUpdate.ts","hooks/useInterval.ts","constants/tetrominos.ts","hooks/useTetromino.ts","hooks/useTetris.ts","containers/Tetris/index.tsx","App.tsx","setupIcons.ts","index.tsx","components/Tile/tile.module.scss","containers/Tetris/tetris.module.scss"],"names":["module","exports","TileFill","Counter","count","memo","Footer","className","styles","footer","link","href","target","rel","icon","Date","getFullYear","Header","header","KeyCode","FillChecker","fill","this","Empty","I","J","L","O","S","T","Z","Tile","isI","isJ","isL","isO","isS","isT","isZ","type","aria-label","classNames","tile","i","j","l","o","s","t","z","MoveCode","useDidMount","callback","useEffect","addId","item","id","nanoid","createMove","code","Rotation","isRotation","Left","offset","rowIndex","columnIndex","Right","Down","isDown","rotateMatrix","matrix","produce","draft","forEach","_","index","map","row","reverse","useDidUpdate","didMount","useRef","deps","current","useInterval","interval","callbackRef","intervalId","setInterval","call","clearInterval","tetrominos","useTetromino","width","useState","tetromino","setTetromino","position","setPosition","randomize","randomTetromino","Math","floor","random","length","makeMove","useTetris","params","height","emptyTiles","useMemo","Array","from","tiles","setTiles","mergedTiles","setMergedTiles","clearedRowsCount","setClearedRowsCount","score","setScore","move","setMove","isAutoDrop","setIsAutoDrop","willTetrominoCollide","some","rowIndexAhead","columnIndexAhead","isEmpty","willCollide","filledRowsIndexes","reduce","acc","push","Tetris","containerRef","focus","data-testid","tetris","ref","onClick","event","preventDefault","onKeyDown","keyCode","ArrowUp","ArrowLeft","ArrowRight","ArrowDown","onKeyUp","style","gridTemplateColumns","App","library","add","faGithub","setupIcons","render","document","getElementById"],"mappings":"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","file":"static/js/main.f756ffb5.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"footer\":\"footer_footer__2RxHW\",\"link\":\"footer_link__2KGou\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"header_header__2l8_Z\",\"link\":\"header_link__3G0Uu\"};","// eslint-disable-next-line no-shadow\nenum TileFill {\n  Empty,\n  I,\n  J,\n  L,\n  O,\n  S,\n  T,\n  Z,\n}\n\nexport default TileFill;\n","import { memo } from 'react';\r\n\r\nconst Counter = ({ count }: { count: number }) => <div>{count}</div>;\r\n\r\nexport default memo(Counter);\r\n","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { memo } from 'react';\r\n\r\nimport styles from './footer.module.scss';\r\n\r\nconst Footer = () => (\r\n  <footer className={styles.footer}>\r\n    <span>\r\n      Powered by\r\n      <a\r\n        className={styles.link}\r\n        href=\"https://github.com/FakeMetalFan\"\r\n        target=\"_blank\"\r\n        rel=\"noopener noreferrer\"\r\n      >\r\n        <FontAwesomeIcon icon={['fab', 'github']} />\r\n      </a>\r\n      &copy;\r\n      <span>{new Date().getFullYear()}</span>\r\n    </span>\r\n  </footer>\r\n);\r\n\r\nexport default memo(Footer);\r\n","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { memo } from 'react';\r\n\r\nimport styles from './header.module.scss';\r\n\r\nconst Header = () => (\r\n  <header className={styles.header}>\r\n    Tetris\r\n    <a\r\n      className={styles.link}\r\n      href=\"https://github.com/FakeMetalFan/tetris\"\r\n      target=\"_blank\"\r\n      rel=\"noopener noreferrer\"\r\n    >\r\n      <FontAwesomeIcon icon={['fab', 'github']} />\r\n    </a>\r\n  </header>\r\n);\r\n\r\nexport default memo(Header);\r\n","// eslint-disable-next-line no-shadow\r\nenum KeyCode {\r\n  ArrowLeft = 37,\r\n  ArrowUp = 38,\r\n  ArrowRight = 39,\r\n  ArrowDown = 40,\r\n}\r\n\r\nexport default KeyCode;\r\n","import TileFill from 'constants/tileFill';\r\n\r\nclass FillChecker {\r\n  constructor(private fill: TileFill) {}\r\n\r\n  get isEmpty() {\r\n    return this.fill === TileFill.Empty;\r\n  }\r\n\r\n  get isI() {\r\n    return this.fill === TileFill.I;\r\n  }\r\n\r\n  get isJ() {\r\n    return this.fill === TileFill.J;\r\n  }\r\n\r\n  get isL() {\r\n    return this.fill === TileFill.L;\r\n  }\r\n\r\n  get isO() {\r\n    return this.fill === TileFill.O;\r\n  }\r\n\r\n  get isS() {\r\n    return this.fill === TileFill.S;\r\n  }\r\n\r\n  get isT() {\r\n    return this.fill === TileFill.T;\r\n  }\r\n\r\n  get isZ() {\r\n    return this.fill === TileFill.Z;\r\n  }\r\n}\r\n\r\nexport default FillChecker;\r\n","import classNames from 'classnames';\r\nimport TileFill from 'constants/tileFill';\r\nimport { memo } from 'react';\r\nimport FillChecker from 'utils/fillChecker';\r\n\r\nimport styles from './tile.module.scss';\r\n\r\nconst Tile = ({ fill }: { fill: TileFill }) => {\r\n  const { isI, isJ, isL, isO, isS, isT, isZ } = new FillChecker(fill);\r\n\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      aria-label=\"tile\"\r\n      className={classNames(styles.tile, {\r\n        [styles.i]: isI,\r\n        [styles.j]: isJ,\r\n        [styles.l]: isL,\r\n        [styles.o]: isO,\r\n        [styles.s]: isS,\r\n        [styles.t]: isT,\r\n        [styles.z]: isZ,\r\n      })}\r\n    />\r\n  );\r\n};\r\n\r\nexport default memo(Tile);\r\n","// eslint-disable-next-line no-shadow\r\nenum MoveCode {\r\n  Rotation,\r\n  Left,\r\n  Right,\r\n  Down,\r\n}\r\n\r\nexport default MoveCode;\r\n","import { useEffect } from 'react';\r\n\r\nconst useDidMount = (callback: () => void) => {\r\n  useEffect(() => {\r\n    callback();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n};\r\n\r\nexport default useDidMount;\r\n","import { nanoid } from 'nanoid';\r\n\r\nconst addId = <T extends Record<string, unknown>>(item: T) => ({\r\n  ...item,\r\n  id: nanoid(),\r\n});\r\n\r\nexport default addId;\r\n","import MoveCode from 'constants/moveCode';\r\n\r\nconst createMove = (code?: MoveCode) => {\r\n  switch (code) {\r\n    case MoveCode.Rotation:\r\n      return { isRotation: true };\r\n    case MoveCode.Left:\r\n      return { offset: { rowIndex: 0, columnIndex: -1 } };\r\n    case MoveCode.Right:\r\n      return { offset: { rowIndex: 0, columnIndex: 1 } };\r\n    case MoveCode.Down:\r\n    default:\r\n      return { isDown: true, offset: { rowIndex: 1, columnIndex: 0 } };\r\n  }\r\n};\r\n\r\nexport default createMove;\r\n","import produce, { Draft } from 'immer';\r\n\r\nconst rotateMatrix = <T>(matrix: T[][]) =>\r\n  produce(matrix, (draft) => {\r\n    draft.forEach((_, index) => {\r\n      // eslint-disable-next-line no-param-reassign\r\n      draft[index] = matrix.map((row) => row[index]) as Draft<T[]>;\r\n    });\r\n\r\n    draft.map((row) => row.reverse());\r\n  });\r\n\r\nexport default rotateMatrix;\r\n","import { useEffect, useRef } from 'react';\r\n\r\nconst useDidUpdate = (callback: () => void, ...deps: unknown[]) => {\r\n  const didMount = useRef(false);\r\n\r\n  useEffect(() => {\r\n    if (didMount.current) {\r\n      callback();\r\n    } else {\r\n      didMount.current = true;\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, deps);\r\n};\r\n\r\nexport default useDidUpdate;\r\n","import { useEffect, useRef } from 'react';\r\n\r\nconst useInterval = (callback: () => void, interval?: number | null) => {\r\n  const callbackRef = useRef<typeof callback>();\r\n\r\n  useEffect(() => {\r\n    callbackRef.current = callback;\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!interval) {\r\n      return undefined;\r\n    }\r\n\r\n    const intervalId = setInterval(() => {\r\n      callbackRef.current?.();\r\n    }, interval);\r\n\r\n    return () => {\r\n      clearInterval(intervalId);\r\n    };\r\n  }, [interval]);\r\n};\r\n\r\nexport default useInterval;\r\n","import TileFill from './tileFill';\n\nconst tetrominos = [\n  [\n    [TileFill.Empty, TileFill.I, TileFill.Empty, TileFill.Empty],\n    [TileFill.Empty, TileFill.I, TileFill.Empty, TileFill.Empty],\n    [TileFill.Empty, TileFill.I, TileFill.Empty, TileFill.Empty],\n    [TileFill.Empty, TileFill.I, TileFill.Empty, TileFill.Empty],\n  ],\n  [\n    [TileFill.Empty, TileFill.J, TileFill.Empty],\n    [TileFill.Empty, TileFill.J, TileFill.Empty],\n    [TileFill.J, TileFill.J, TileFill.Empty],\n  ],\n  [\n    [TileFill.Empty, TileFill.L, TileFill.Empty],\n    [TileFill.Empty, TileFill.L, TileFill.Empty],\n    [TileFill.Empty, TileFill.L, TileFill.L],\n  ],\n  [\n    [TileFill.O, TileFill.O],\n    [TileFill.O, TileFill.O],\n  ],\n  [\n    [TileFill.Empty, TileFill.S, TileFill.S],\n    [TileFill.S, TileFill.S, TileFill.Empty],\n    [TileFill.Empty, TileFill.Empty, TileFill.Empty],\n  ],\n  [\n    [TileFill.Empty, TileFill.T, TileFill.Empty],\n    [TileFill.T, TileFill.T, TileFill.T],\n    [TileFill.Empty, TileFill.Empty, TileFill.Empty],\n  ],\n  [\n    [TileFill.Z, TileFill.Z, TileFill.Empty],\n    [TileFill.Empty, TileFill.Z, TileFill.Z],\n    [TileFill.Empty, TileFill.Empty, TileFill.Empty],\n  ],\n];\n\nexport default tetrominos;\n","import tetrominos from 'constants/tetrominos';\nimport TileFill from 'constants/tileFill';\nimport produce from 'immer';\nimport { useState } from 'react';\nimport rotateMatrix from 'utils/rotateMatrix';\n\nconst useTetromino = ({ width }: TetrisParams) => {\n  const [tetromino, setTetromino] = useState<TileFill[][]>([]);\n\n  const [position, setPosition] = useState({ rowIndex: 0, columnIndex: 0 });\n\n  const randomize = () => {\n    const randomTetromino =\n      tetrominos[Math.floor(Math.random() * tetrominos.length)];\n\n    setTetromino(randomTetromino);\n    setPosition({\n      rowIndex: 0,\n      columnIndex: Math.floor((width - randomTetromino.length) / 2),\n    });\n  };\n\n  const makeMove = ({\n    isRotation,\n    offset = { rowIndex: 0, columnIndex: 0 },\n  }: Move) => {\n    if (isRotation) {\n      setTetromino(rotateMatrix(tetromino));\n    } else {\n      setPosition(\n        produce(position, (draft) => {\n          /* eslint-disable no-param-reassign */\n          draft.rowIndex += offset.rowIndex;\n          draft.columnIndex += offset.columnIndex;\n        })\n      );\n    }\n  };\n\n  return { tetromino, position, randomize, makeMove };\n};\n\nexport default useTetromino;\n","import TileFill from 'constants/tileFill';\r\nimport produce from 'immer';\r\nimport { useEffect, useMemo, useState } from 'react';\r\nimport addId from 'utils/addId';\r\nimport createMove from 'utils/createMove';\r\nimport FillChecker from 'utils/fillChecker';\r\nimport rotateMatrix from 'utils/rotateMatrix';\r\n\r\nimport useDidUpdate from './useDidUpdate';\r\nimport useInterval from './useInterval';\r\nimport useTetromino from './useTetromino';\r\n\r\nconst useTetris = (params: TetrisParams) => {\r\n  const { width, height } = params;\r\n\r\n  const emptyTiles = useMemo(\r\n    () =>\r\n      Array.from({ length: height }, () =>\r\n        Array.from({ length: width }, () => addId({ fill: TileFill.Empty }))\r\n      ),\r\n    [height, width]\r\n  );\r\n\r\n  const [tiles, setTiles] = useState(emptyTiles);\r\n\r\n  const [mergedTiles, setMergedTiles] = useState(emptyTiles);\r\n\r\n  const [clearedRowsCount, setClearedRowsCount] = useState(0);\r\n\r\n  const [score, setScore] = useState(0);\r\n\r\n  const [move, setMove] = useState<Move>({});\r\n\r\n  const [isAutoDrop, setIsAutoDrop] = useState(true);\r\n\r\n  const { tetromino, position, randomize, makeMove } = useTetromino(params);\r\n\r\n  const willTetrominoCollide = ({\r\n    matrix = tetromino,\r\n    offset = { rowIndex: 0, columnIndex: 0 },\r\n  }: { matrix?: TileFill[][]; offset?: Position } = {}) =>\r\n    matrix.some((row, rowIndex) =>\r\n      row.some((fill, columnIndex) => {\r\n        const rowIndexAhead = rowIndex + position.rowIndex + offset.rowIndex;\r\n        const columnIndexAhead =\r\n          columnIndex + position.columnIndex + offset.columnIndex;\r\n\r\n        return (\r\n          !new FillChecker(fill).isEmpty &&\r\n          (!new FillChecker(\r\n            mergedTiles[rowIndexAhead]?.[columnIndexAhead]?.fill\r\n          ).isEmpty ||\r\n            rowIndexAhead >= height ||\r\n            columnIndexAhead >= width ||\r\n            columnIndexAhead < 0)\r\n        );\r\n      })\r\n    );\r\n\r\n  useEffect(() => {\r\n    randomize();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [mergedTiles]);\r\n\r\n  useDidUpdate(\r\n    () => {\r\n      if (willTetrominoCollide()) {\r\n        setTiles(emptyTiles);\r\n        setMergedTiles(emptyTiles);\r\n        setClearedRowsCount(0);\r\n      } else {\r\n        setTiles(\r\n          produce(mergedTiles, (draft) => {\r\n            tetromino.forEach((row, rowIndex) => {\r\n              row.forEach((fill, columnIndex) => {\r\n                if (!new FillChecker(fill).isEmpty) {\r\n                  /* eslint-disable no-param-reassign */\r\n                  draft[rowIndex + position.rowIndex][\r\n                    columnIndex + position.columnIndex\r\n                  ].fill = fill;\r\n                }\r\n              });\r\n            });\r\n          })\r\n        );\r\n      }\r\n    },\r\n    tetromino,\r\n    position\r\n  );\r\n\r\n  useDidUpdate(() => {\r\n    const willCollide = willTetrominoCollide(\r\n      move.isRotation ? { matrix: rotateMatrix(tetromino) } : move\r\n    );\r\n\r\n    if (willCollide && move.isDown) {\r\n      const filledRowsIndexes = tiles.reduce((acc: number[], row, rowIndex) => {\r\n        const hasEmptyTiles = row.some(\r\n          (tile) => new FillChecker(tile.fill).isEmpty\r\n        );\r\n\r\n        if (!hasEmptyTiles) {\r\n          acc.push(rowIndex);\r\n        }\r\n\r\n        return acc;\r\n      }, []);\r\n\r\n      const { length } = filledRowsIndexes;\r\n\r\n      if (length) {\r\n        setClearedRowsCount(clearedRowsCount + length);\r\n        setMergedTiles(\r\n          produce(tiles, (draft) => {\r\n            filledRowsIndexes.forEach((index) => {\r\n              for (let rowIndex = index; rowIndex; rowIndex -= 1) {\r\n                draft[rowIndex].forEach((tile, columnIndex) => {\r\n                  tile.fill = draft[rowIndex - 1][columnIndex].fill;\r\n                });\r\n              }\r\n            });\r\n          })\r\n        );\r\n      } else {\r\n        setMergedTiles(tiles);\r\n      }\r\n    } else if (!willCollide) {\r\n      makeMove(move);\r\n    }\r\n  }, move);\r\n\r\n  useDidUpdate(() => {\r\n    setScore(clearedRowsCount ? score + clearedRowsCount * 10 : 0);\r\n  }, clearedRowsCount);\r\n\r\n  useInterval(\r\n    () => {\r\n      setMove(createMove());\r\n    },\r\n    isAutoDrop ? 1e3 : null\r\n  );\r\n\r\n  return { tiles, score, setMove, setIsAutoDrop };\r\n};\r\n\r\nexport default useTetris;\r\n","import Counter from 'components/Counter';\r\nimport Footer from 'components/Footer';\r\nimport Header from 'components/Header';\r\nimport Tile from 'components/Tile';\r\nimport KeyCode from 'constants/keyCode';\r\nimport MoveCode from 'constants/moveCode';\r\nimport useDidMount from 'hooks/useDidMount';\r\nimport useTetris from 'hooks/useTetris';\r\nimport { KeyboardEvent, SyntheticEvent, useRef } from 'react';\r\nimport createMove from 'utils/createMove';\r\n\r\nimport styles from './tetris.module.scss';\r\n\r\nconst Tetris = (params: TetrisParams) => {\r\n  const { width } = params;\r\n\r\n  const containerRef = useRef<HTMLAnchorElement>(null);\r\n\r\n  const { tiles, score, setMove, setIsAutoDrop } = useTetris(params);\r\n\r\n  const handleClick = (event: SyntheticEvent<HTMLAnchorElement>) => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  const handleKeyDown = ({ keyCode }: KeyboardEvent) => {\r\n    switch (keyCode) {\r\n      case KeyCode.ArrowUp:\r\n        setMove(createMove(MoveCode.Rotation));\r\n        break;\r\n      case KeyCode.ArrowLeft:\r\n        setMove(createMove(MoveCode.Left));\r\n        break;\r\n      case KeyCode.ArrowRight:\r\n        setMove(createMove(MoveCode.Right));\r\n        break;\r\n      case KeyCode.ArrowDown:\r\n      default:\r\n        setIsAutoDrop(false);\r\n        setMove(createMove());\r\n    }\r\n  };\r\n\r\n  const handleKeyUp = ({ keyCode }: KeyboardEvent) => {\r\n    if (keyCode === KeyCode.ArrowDown) {\r\n      setIsAutoDrop(true);\r\n    }\r\n  };\r\n\r\n  useDidMount(() => {\r\n    containerRef.current?.focus();\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <Header />\r\n      <main>\r\n        <a\r\n          href=\"/\"\r\n          data-testid={styles.tetris}\r\n          className={styles.tetris}\r\n          ref={containerRef}\r\n          onClick={handleClick}\r\n          onKeyDown={handleKeyDown}\r\n          onKeyUp={handleKeyUp}\r\n        >\r\n          <div className={styles.score}>\r\n            <Counter count={score} />\r\n          </div>\r\n          <div\r\n            data-testid={styles.tiles}\r\n            className={styles.tiles}\r\n            style={{ gridTemplateColumns: `repeat(${width}, 1fr)` }}\r\n          >\r\n            {tiles.map((row) =>\r\n              row.map(({ fill, id }) => <Tile fill={fill} key={id} />)\r\n            )}\r\n          </div>\r\n        </a>\r\n      </main>\r\n      <Footer />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Tetris;\r\n","import Tetris from 'containers/Tetris';\n\nconst App = () => <Tetris width={10} height={20} />;\n\nexport default App;\n","import { library } from '@fortawesome/fontawesome-svg-core';\nimport { faGithub } from '@fortawesome/free-brands-svg-icons';\n\nconst setupIcons = () => {\n  library.add(faGithub);\n};\n\nexport default setupIcons;\n","import 'index.scss';\n\nimport App from 'App';\nimport { StrictMode } from 'react';\nimport { render } from 'react-dom';\nimport setupIcons from 'setupIcons';\n\nsetupIcons();\n\nrender(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n  document.getElementById('root')\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tile\":\"tile_tile__3mwM6\",\"i\":\"tile_i__25_aJ\",\"j\":\"tile_j__TNRBZ\",\"l\":\"tile_l__Zpgje\",\"o\":\"tile_o__2wu3P\",\"s\":\"tile_s__12WnI\",\"t\":\"tile_t__2_6li\",\"z\":\"tile_z__2vgfH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tetris\":\"tetris_tetris__1xn-2\",\"tiles\":\"tetris_tiles__QqxGq\",\"score\":\"tetris_score__XB5WE\"};"],"sourceRoot":""}