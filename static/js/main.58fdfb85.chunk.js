(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{12:function(e,t,n){e.exports={footer:"footer_footer__2RxHW",link:"footer_link__2KGou"}},13:function(e,t,n){e.exports={header:"header_header__2l8_Z",link:"header_link__3G0Uu"}},14:function(e,t,n){e.exports={tiles:"tiles_tiles__1LOVM"}},20:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);n(20);var o,r=n(0),i=n(1),c=function(e){var t=e.className,n=e.count;return Object(i.jsx)("div",{className:t,children:n})},a=Object(r.memo)(c),u=n(8),s=n(12),f=n.n(s),l=function(){return Object(i.jsx)("footer",{className:f.a.footer,children:Object(i.jsxs)("span",{children:["Powered by",Object(i.jsx)("a",{className:f.a.link,href:"https://github.com/FakeMetalFan",target:"_blank",rel:"noopener noreferrer",children:Object(i.jsx)(u.a,{icon:["fab","github"]})}),"\xa9",Object(i.jsx)("span",{children:(new Date).getFullYear()})]})})},d=Object(r.memo)(l),j=n(13),b=n.n(j),v=function(){return Object(i.jsxs)("header",{className:b.a.header,children:["Tetris",Object(i.jsx)("a",{className:b.a.link,href:"https://github.com/FakeMetalFan/tetris",target:"_blank",rel:"noopener noreferrer",children:Object(i.jsx)(u.a,{icon:["fab","github"]})})]})},O=Object(r.memo)(v),h=n(3),m=n(16),x=n.n(m);!function(e){e[e.I=1]="I",e[e.J=2]="J",e[e.L=3]="L",e[e.O=4]="O",e[e.S=5]="S",e[e.T=6]="T",e[e.Z=7]="Z"}(o||(o={}));var w,_=o,I=n(5),p=n.n(I),g=function(e){var t,n=e.fill;return Object(i.jsx)("button",{type:"button","aria-label":"tile",className:x()(p.a.tile,(t={},Object(h.a)(t,p.a.i,n===_.I),Object(h.a)(t,p.a.j,n===_.J),Object(h.a)(t,p.a.l,n===_.L),Object(h.a)(t,p.a.o,n===_.O),Object(h.a)(t,p.a.s,n===_.S),Object(h.a)(t,p.a.t,n===_.T),Object(h.a)(t,p.a.z,n===_.Z),t))})},k=Object(r.memo)(g),R=n(14),A=n.n(R),S=function(e){var t=e.width,n=e.tiles;return Object(i.jsx)("div",{"data-testid":A.a.tiles,className:A.a.tiles,style:{gridTemplateColumns:"repeat(".concat(t,", 1fr)")},children:n.map((function(e){return e.map((function(e){var t=e.fill,n=e.id;return Object(i.jsx)(k,{fill:t},n)}))}))})},L=Object(r.memo)(S);!function(e){e[e.ArrowLeft=37]="ArrowLeft",e[e.ArrowUp=38]="ArrowUp",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowDown=40]="ArrowDown"}(w||(w={}));var D,M=w;!function(e){e[e.Rotation=0]="Rotation",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Down=3]="Down"}(D||(D={}));var E=D,y=function(e){Object(r.useEffect)(e,[])},N=n(4),J=n(6),T=n(15),Z=n(19),F=function(e){return Object(T.a)(Object(T.a)({},e),{},{id:Object(Z.a)()})},z=function(e){switch(e){case E.Rotation:return{isRotation:!0};case E.Left:return{offset:{rowIndex:0,columnIndex:-1}};case E.Right:return{offset:{rowIndex:0,columnIndex:1}};case E.Down:default:return{isDown:!0,offset:{rowIndex:1,columnIndex:0}}}},U=function(e){return Object(J.a)(e,(function(t){t.forEach((function(n,o){t[o]=e.map((function(e){return e[o]}))})),t.map((function(e){return e.reverse()}))}))},C=function(e){for(var t=Object(r.useRef)(!1),n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];Object(r.useEffect)((function(){t.current?e():t.current=!0}),o)},B=function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e})),Object(r.useEffect)((function(){if(t){var e=setInterval((function(){var e;null===(e=n.current)||void 0===e||e.call(n)}),t);return function(){clearInterval(e)}}}),[t])},K=[[[void 0,_.I,void 0,void 0],[void 0,_.I,void 0,void 0],[void 0,_.I,void 0,void 0],[void 0,_.I,void 0,void 0]],[[void 0,_.J,void 0],[void 0,_.J,void 0],[_.J,_.J,void 0]],[[void 0,_.L,void 0],[void 0,_.L,void 0],[void 0,_.L,_.L]],[[_.O,_.O],[_.O,_.O]],[[void 0,_.S,_.S],[_.S,_.S,void 0],[void 0,void 0,void 0]],[[void 0,_.T,void 0],[_.T,_.T,_.T],[void 0,void 0,void 0]],[[_.Z,_.Z,void 0],[void 0,_.Z,_.Z],[void 0,void 0,void 0]]],W=function(e){var t=e.width,n=Object(r.useState)([]),o=Object(N.a)(n,2),i=o[0],c=o[1],a=Object(r.useState)({rowIndex:0,columnIndex:0}),u=Object(N.a)(a,2),s=u[0],f=u[1];return{tetromino:i,position:s,randomize:function(){var e=K[Math.floor(Math.random()*K.length)];c(e),f({rowIndex:0,columnIndex:Math.floor((t-e.length)/2)})},makeMove:function(e){var t=e.isRotation,n=e.offset,o=void 0===n?{rowIndex:0,columnIndex:0}:n;t?c(U(i)):f(Object(J.a)(s,(function(e){e.rowIndex+=o.rowIndex,e.columnIndex+=o.columnIndex})))}}},G=function(e){var t=e.width,n=e.height,o=Object(r.useMemo)((function(){return Array.from({length:n},(function(){return Array.from({length:t},(function(){return F({})}))}))}),[n,t]),i=Object(r.useState)(o),c=Object(N.a)(i,2),a=c[0],u=c[1],s=Object(r.useState)(o),f=Object(N.a)(s,2),l=f[0],d=f[1],j=Object(r.useState)(0),b=Object(N.a)(j,2),v=b[0],O=b[1],h=Object(r.useState)(0),m=Object(N.a)(h,2),x=m[0],w=m[1],_=Object(r.useState)({}),I=Object(N.a)(_,2),p=I[0],g=I[1],k=Object(r.useState)(!0),R=Object(N.a)(k,2),A=R[0],S=R[1],L=W(e),D=L.tetromino,M=L.position,E=L.randomize,y=L.makeMove,T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.matrix,r=void 0===o?D:o,i=e.offset,c=void 0===i?{rowIndex:0,columnIndex:0}:i;return r.some((function(e,o){return e.some((function(e,r){var i,a,u=o+M.rowIndex+c.rowIndex,s=r+M.columnIndex+c.columnIndex;return e&&((null===(i=l[u])||void 0===i||null===(a=i[s])||void 0===a?void 0:a.fill)||u>=n||s>=t||s<0)}))}))};return Object(r.useEffect)(E,[l]),C((function(){T()?(u(o),d(o),O(0)):u(Object(J.a)(l,(function(e){D.forEach((function(t,n){t.forEach((function(t,o){t&&(e[n+M.rowIndex][o+M.columnIndex].fill=t)}))}))})))}),D,M),C((function(){var e=T(p.isRotation?{matrix:U(D)}:p);if(e&&p.isDown){var t=a.reduce((function(e,t,n){return t.some((function(e){return!e.fill}))||e.push(n),e}),[]),n=t.length;n?(O(v+n),d(Object(J.a)(a,(function(e){t.forEach((function(t){for(var n=function(t){e[t].forEach((function(n,o){n.fill=e[t-1][o].fill}))},o=t;o;o-=1)n(o)}))})))):d(a)}else e||y(p)}),p),C((function(){w(v?x+10*v:0)}),v),B((function(){g(z())}),A?1e3:null),{tiles:a,score:x,setMove:g,setIsAutoDrop:S}},H=n(9),P=n.n(H),V=function(e){var t=e.width,n=Object(r.useRef)(null),o=G(e),c=o.tiles,u=o.score,s=o.setMove,f=o.setIsAutoDrop;return y((function(){var e;null===(e=n.current)||void 0===e||e.focus()})),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(O,{}),Object(i.jsxs)("a",{href:"/","data-testid":P.a.tetris,className:P.a.tetris,ref:n,onClick:function(e){e.preventDefault()},onKeyDown:function(e){switch(e.keyCode){case M.ArrowUp:s(z(E.Rotation));break;case M.ArrowLeft:s(z(E.Left));break;case M.ArrowRight:s(z(E.Right));break;case M.ArrowDown:default:f(!1),s(z())}},onKeyUp:function(e){e.keyCode===M.ArrowDown&&f(!0)},children:[Object(i.jsx)(a,{className:P.a.score,count:u}),Object(i.jsx)(L,{width:t,tiles:c})]}),Object(i.jsx)(d,{})]})},X=n(17),Y=n(7),q=n(18);(function(){Y.b.add(q.a)})(),Object(X.render)(Object(i.jsx)(r.StrictMode,{children:Object(i.jsx)(V,{width:10,height:20})}),document.getElementById("root"))},5:function(e,t,n){e.exports={tile:"tile_tile__3mwM6",i:"tile_i__25_aJ",j:"tile_j__TNRBZ",l:"tile_l__Zpgje",o:"tile_o__2wu3P",s:"tile_s__12WnI",t:"tile_t__2_6li",z:"tile_z__2vgfH"}},9:function(e,t,n){e.exports={tetris:"tetris_tetris__1xn-2",score:"tetris_score__XB5WE"}}},[[31,1,2]]]);
//# sourceMappingURL=main.58fdfb85.chunk.js.map