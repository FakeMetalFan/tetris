(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{182:function(e,t,n){},183:function(e,t,n){},184:function(e,t,n){},185:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(67),c=(n(76),function(e){var t=e.state,n=e.width;return a.a.createElement("div",{className:"display",style:{gridTemplateColumns:"repeat(".concat(n,", 1fr)")}},t.map((function(e){return e.map((function(e,t){return a.a.createElement(se,{key:t,state:e})}))})))}),i=n(26),s=(n(82),function(){return a.a.createElement("footer",null,a.a.createElement("span",null,"Powered by",a.a.createElement("a",{href:"https://github.com/FakeMetalFan",target:"_blank",rel:"noopener noreferrer"},a.a.createElement(i.a,{icon:["fab","github"]})),"\xa9",a.a.createElement("span",null,(new Date).getFullYear())))}),u=(n(83),function(){return a.a.createElement("header",null,a.a.createElement("span",{className:"title"},"Tetris"),a.a.createElement("a",{href:"https://github.com/FakeMetalFan/tetris",target:"_blank",rel:"noopener noreferrer"},a.a.createElement(i.a,{icon:["fab","github"]})))}),f=n(9),l=n(2),w=function(e){var t=Object(r.useRef)(),n=Object(r.useRef)(!1);Object(r.useEffect)((function(){t.current=e}),[e]);for(var a=arguments.length,o=new Array(a>1?a-1:0),c=1;c<a;c++)o[c-1]=arguments[c];Object(r.useEffect)((function(){n.current?t.current():n.current=!0}),o)},d=n(68),m=n.n(d),p=n(69),b=n.n(p),h=n(15),v=n(14),y=n(5),j=n(27),O=37,E=38,g=39,k=40,A=0,R=1,x=2,C=3,D=4,M=5,S=6,F=7,N=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A;Object(y.a)(this,e),this.fill=t}return Object(j.a)(e,[{key:"isEmpty",get:function(){return this.fill===A}}]),e}(),_=[[[new N,new N(R),new N,new N],[new N,new N(R),new N,new N],[new N,new N(R),new N,new N],[new N,new N(R),new N,new N]],[[new N,new N(x),new N],[new N,new N(x),new N],[new N(x),new N(x),new N]],[[new N,new N(C),new N],[new N,new N(C),new N],[new N,new N(C),new N(C)]],[[new N(D),new N(D)],[new N(D),new N(D)]],[[new N,new N(M),new N(M)],[new N(M),new N(M),new N],[new N,new N,new N]],[[new N,new N(S),new N],[new N(S),new N(S),new N(S)],[new N,new N,new N]],[[new N(F),new N(F),new N],[new N,new N(F),new N(F)],[new N,new N,new N]]],I=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(y.a)(this,e),this[l.b]=!0,this.rowAddress=t,this.colAddress=n},z={Left:new I(0,-1),Right:new I(0,1),Down:new I(1)},J=function(){function e(){Object(y.a)(this,e),this._id=Symbol()}return Object(j.a)(e,[{key:"isRotation",get:function(){return this instanceof L}},{key:"isDown",get:function(){return this instanceof U}}]),e}(),K=function(e){Object(h.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(y.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).offset=z.Left,e}return n}(J),L=function(e){Object(h.a)(n,e);var t=Object(v.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return n}(J),T=function(e){Object(h.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(y.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).offset=z.Right,e}return n}(J),U=function(e){Object(h.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(y.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).offset=z.Down,e}return n}(J),B=function(e){return Object(l.a)(e,(function(t){t.forEach((function(n,r){t[r]=e.map((function(e){return e[r]}))})),t.map((function(e){return e.reverse()}))}))},P="draw-tetromino",Y="sweep-filled-rows",q="merge-state",G="reset",H=function(e,t){var n=t.type,r=t.payload;return n===G?m()(r):Object(l.a)(e,(function(e){switch(n){case P:e.current=Object(l.a)(e.merged,(function(e){var t=r.matrix,n=r.position;t.forEach((function(t,r){t.forEach((function(t,a){!t.isEmpty&&(e[r+n.rowAddress][a+n.colAddress]=t)}))}))}));break;case Y:var t=r.filledRowsAddresses,a=r.emptyRow;e.sweptRowsCount+=t.length,e.merged=Object(l.a)(e.current,(function(e){t.forEach((function(t){e.splice(t,1),e.unshift(a)}))}));break;case q:e.merged=e.current}}))},Q="random",V="rotation",W="move",X=function(e,t){var n=t.type,r=t.payload;return Object(l.a)(e,(function(e){switch(n){case Q:e.id=Symbol(),e.matrix=_[Math.random()*_.length|0],e.position=new I(0,(r.width-e.matrix.length)/2|0);break;case W:var t=r.offset,a=t.rowAddress,o=void 0===a?0:a,c=t.colAddress,i=void 0===c?0:c;e.position=Object(l.a)(e.position,(function(e){e.rowAddress+=o,e.colAddress+=i}));break;case V:e.matrix=B(e.matrix)}}))},Z=function(e){var t=e.width,n=Object(r.useReducer)(X,{id:Symbol(),matrix:[],position:new I}),a=Object(f.a)(n,2),o=a[0],c=o.id,i=o.matrix,s=o.position,u=a[1];return{id:c,matrix:i,position:s,randomize:function(){u({type:Q,payload:{width:t}})},makeMove:function(e){var t=e.isRotation,n=e.offset;u(t?{type:V}:{type:W,payload:{offset:n}})}}},$=(n(182),"left-move"),ee="rotation",te="right-move",ne="down-move",re="enable-auto-drop",ae="update-score",oe="auto-drop",ce=function(e,t){var n=t.type,r=t.payload;return Object(l.a)(e,(function(e){switch(n){case $:e.move=new K;break;case ee:e.move=new L;break;case te:e.move=new T;break;case ne:e.isAutoDrop=!1,e.move=new U;break;case re:e.isAutoDrop=!0;break;case ae:var t=r.sweptRowsCount;e.score=t?e.score+10*t:0;break;case oe:e.move=new U}}))},ie=function(e){var t=e.width,n=e.height,o=Object(r.useReducer)(ce,{score:0,move:null,isAutoDrop:!0}),i=Object(f.a)(o,2),s=i[0],u=s.score,l=s.move,d=s.isAutoDrop,m=i[1],p=function(e){var t=e.width,n=e.height,a=e.move,o=Object(r.useMemo)((function(){return Array(t).fill(new N)}),[t]),c=Object(r.useMemo)((function(){return Array(n).fill(o)}),[o,n]),i={current:c,merged:c,sweptRowsCount:0},s=Object(r.useReducer)(H,i),u=Object(f.a)(s,2),l=u[0],d=l.current,m=l.merged,p=l.sweptRowsCount,h=u[1],v=Z({width:t}),y=v.id,j=v.matrix,O=v.position,E=v.randomize,g=v.makeMove,k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.tetrominoState,a=void 0===r?j:r,o=e.offset,c=void 0===o?new I:o;return a.some((function(e,r){return e.some((function(e,a){var o,i,s=e.isEmpty,u=r+O.rowAddress+c.rowAddress,f=a+O.colAddress+c.colAddress;return!s&&(!(null===(o=m[u])||void 0===o||null===(i=o[f])||void 0===i?void 0:i.isEmpty)||u>=n||f>=t||f<0)}))}))};return Object(r.useEffect)((function(){E()}),[m]),Object(r.useEffect)((function(){h({type:P,payload:{matrix:j,position:O}})}),[j,O]),w((function(){if(k(a.isRotation?{tetrominoState:B(j)}:a)){if(a.isDown){var e=d.reduce((function(e,t,n){return!b()(t,"isEmpty")&&e.push(n),e}),[]);h(e.length?{type:Y,payload:{filledRowsAddresses:e,emptyRow:o}}:{type:q})}}else g(a)}),a),w((function(){k()&&h({type:G,payload:i})}),y),{sweptRowsCount:p,displayState:d}}({width:t,height:n,move:l}),h=p.displayState,v=p.sweptRowsCount,y=Object(r.useRef)();return Object(r.useEffect)((function(){y.current.focus()}),[]),w((function(){m({type:ae,payload:{sweptRowsCount:v}})}),v),function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(t){var e=setInterval((function(){n.current()}),t);return function(){clearInterval(e)}}}),[t])}((function(){m({type:oe})}),d?800:null),a.a.createElement("div",{className:"tetris",tabIndex:"0",onKeyDown:function(e){var t=e.keyCode;t===O&&m({type:$}),t===E&&m({type:ee}),t===g&&m({type:te}),t===k&&m({type:ne})},onKeyUp:function(e){e.keyCode===k&&m({type:re})},ref:y},a.a.createElement("div",{className:"score"},u),a.a.createElement(c,{state:h,width:t}))},se=(n(183),Object(r.memo)((function(e){var t=e.state.fill,n="tile tile__";switch(t){case A:n+="none";break;case R:n+="i";break;case x:n+="j";break;case C:n+="l";break;case D:n+="o";break;case M:n+="s";break;case S:n+="t";break;case F:n+="z";break;default:throw new Error('Unexpected tile fill of "'.concat(t,'"!'))}return a.a.createElement("div",{className:n})}))),ue=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(u,null),a.a.createElement(ie,{width:10,height:20}),a.a.createElement(s,null))},fe=n(13),le=n(70);n(184);fe.b.add(le.a),Object(o.render)(a.a.createElement(r.StrictMode,null,a.a.createElement(ue,null)),document.getElementById("root"))},71:function(e,t,n){e.exports=n(185)},76:function(e,t,n){},82:function(e,t,n){},83:function(e,t,n){}},[[71,1,2]]]);
//# sourceMappingURL=main.1c6bc4ac.chunk.js.map